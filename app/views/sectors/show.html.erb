<script src="//maps.google.com/maps/api/js?v=3&key=AIzaSyBT8YfomN3I0pj0lv7cqib2t3esrnCutBo"></script>
<script src="//cdn.rawgit.com/mahnunchik/markerclustererplus/master/dist/markerclusterer.min.js"></script>
<script src='//cdn.rawgit.com/printercu/google-maps-utility-library-v3-read-only/master/infobox/src/infobox_packed.js' type='text/javascript'></script> <!-- only if you need custom infoboxes -->
<h3 class="hdetail">Components of site <i><%= @sector.code %></i></h3>

<div id ="detaliu">
<table>
  <tr>
  <th>ID No.</th>
  <th>Country</th>
  <th>County</th>
    <th>Commune</th>
    <th>Locality</th>
    <th>Toponym</th>
  </tr>
  <tr>
  <td><%=@sector.code %></td>
  <td><%=@sector.country %></td>
  <td><% unless @sector.county.blank? %><%=h @sector.county.name %> <% end %></td>
  <td><%=@sector.locality %></td>
  <td><%=@sector.village %></td>
  <td><%=@sector.point %></td>
  </tr>
  <tr>
    <td></td>
  </tr>
  <tr>
    <th>Site name</th>
    <th>RAN Code</th>
    <th>LMI Code</th>
    <th>Siruta Code</th>
  </tr>
  <tr>
    <td><%=@sector.name %></td>
    <td><%=@sector.ran %></td>
    <td><%=@sector.lmi %></td>
    <td><%=@sector.siruta %></td>
  </tr>
  <tr>
    <td></td>
  </tr>
  <tr>
    <th>Address</th>
    <th>Ownership</th>
    <th>Owner</th>
    <th>Topographical No.</th>
    <th>Cadastral lot</th>
  </tr>
  <tr>
    <td><%=@sector.address %></td>
    <td><%=@sector.property %></td>
    <td><%=@sector.owner %></td>
    <td><%=@sector.topo %></td>
    <td><%=@sector.cadastral %></td>
  </tr>
  <tr>
    <td></td>
  </tr>
  <tr>
    <th>Site category</th>
    <th>Site type</th>
    <th>Institution in charge of sector</th>
    <th>Institution in charge</th>
    <th>Code Map/ortophoto plan</th>
    <th>Central Coordinate</th>
  </tr>
  <tr>
    <td><% unless @sector.scategory.blank? %><%=h @sector.scategory.name %> <% end %></td>
    <td><% unless @sector.component.blank? %><%=h @sector.component.name %> <% end %></td>
    <td><%= @sector.sect_responsible %></td>
    <td><%= @sector.institution %></td>
    <td><%= @sector.map_code %></td>
    <td><% @sector.coordinates.where('ctype'=>"centre").each do |coordinate| %>
          <ul>
            <li>
              Lat:<%= coordinate.xdegree %>°<%= coordinate.xmin %>'<%= coordinate.xsec %>"</li>
            <li>
              Lng:<%= coordinate.ydegree %>°<%= coordinate.ymin %>'<%= coordinate.ysec %>"</li>
          </ul>
      <% end %>
          </td>
  </tr>
  <tr>
    <td></td>
  </tr>
  <tr>
    <th>Measurements</th>
    <th>Area</th>
    <th>Length</th>
    <th>Width</th>
    <th>Height</th>
    <th>Diameter</th>
    <th>Description</th>
  </tr>
  <tr>
    <td><%= @sector.d_type %></td>
    <td><%= @sector.area %></td>
    <td><%= @sector.d_length %></td>
    <td><%= @sector.d_width %></td>
    <td><%= @sector.d_height %></td>
    <td><%= @sector.d_o %></td>
    <td><%= @sector.description %></td>
  </tr>
  <tr>
    <td></td>
  </tr>
  <tr>
    <th>Dating</th>
    <th>Land form</th>
    <th>River basin</th>
    <th>Stratigraphy</th>
    <th>Vegetation/Soil</th>
  </tr>
  <tr>
    <td><%= @sector.chronology %></td>
    <td><%= @sector.relief %></td>
    <td><%= @sector.river %></td>
    <td><%= @sector.stratigraphy %></td>
    <td><%= @sector.soil_type %></td>
  </tr>
  <tr>
    <td></td>
  </tr>
  <tr>
    <th>Preservation Status</th>
  </tr>
  <tr>
    <td>
      <% @sector.preservations.each do |preservation| %>
          <ul>
          <li><%= preservation.name %></li>
          </ul>
       <% end %>
    </td>
  </tr>
  <tr>
    <td>
    </td>
  </tr>
  <tr>
    <th>Earthquakes</th>
    <th>Floods</th>
    <th>Wild fires</th>
    <th>Animals</th>
    <th>Insects</th>
    <th>Storms</th>
    <th>Landslide</th>
    <th>Water logged soil</th>
    <th>High salinity soil</th>
    <th>Acidic soil</th>
  </tr>
  <tr>
    <td><%= @sector.earthquake %></td>
    <td><%= @sector.flood %></td>
    <td><%= @sector.fire %></td>
    <td><%= @sector.animal %></td>
    <td><%= @sector.insect %></td>
    <td><%= @sector.storm %></td>
    <td><%= @sector.landslide %></td>
    <td><%= @sector.water %></td>
    <td><%= @sector.salt %></td>
    <td><%= @sector.acid %></td>
  </tr>
  <tr>
    <td></td>
  </tr>
  <tr>
    <th>Demolition</th>
    <th>Partially affected</th>
    <th>Vandalism</th>
    <th>Thefts</th>
    <th>Arson</th>
    <th>Agricultural work</th>
    <th>Forestry work</th>
  </tr>
  <tr>
    <td><%= @sector.demolition %></td>
    <td><%= @sector.partial %></td>
    <td><%= @sector.vandalism %></td>
    <td><%= @sector.theft %></td>
    <td><%= @sector.arson %></td>
    <td><%= @sector.agriculture %></td>
    <td><%= @sector.forest %></td>
  </tr>
  <tr>
    <td></td>
  </tr>
  <tr>
    <th>North demarcation</th>
    <th>East demarcation</th>
    <th>South demarcation</th>
    <th>West demarcation</th>
  </tr>
  <tr>
    <td><%= @sector.d_north %></td>
    <td><%= @sector.d_east %></td>
    <td><%= @sector.d_south %></td>
    <td><%= @sector.d_west %></td>
  </tr>
  <tr>
    <td></td>
  </tr>
  <tr>
    <th>Monument protection</th>
    <th>National Monument protection Law</th>
    <th>Plannning tools</th>
    <th>Plannning tools</th>
    <th>Other laws and instruments</th>
  </tr>
  <tr>
    <td>
      <% @sector.monuments.each do |monument| %>
          <ul>
            <li><%= monument.name %></li>
          </ul>
      <% end %>
    </td>
    <td><%= @sector.national %></td>
    <td><%= @sector.urbanism %></td>
    <td><%= @sector.other %></td>
  </tr>
  <tr>
    <td></td>
  </tr>
  <tr>
    <th>Land use </th>
    <th>Accessibility </th>
  </tr>
  <tr>
    <td>
      <% @sector.lands.each do |land| %>
          <ul>
            <li><%= land.name %></li>
          </ul>
      <% end %>
    </td>
    <td>
      <% @sector.saccesses.each do |access| %>
          <ul>
            <li><%= access.name %></li>
          </ul>
      <% end %>
    </td>
  </tr>
  <tr>
    <td></td>
  </tr>
  <tr>
    <th>Research</th>
    <th>Restorations</th>
    <th>Geophysics</th>
    <th>Finds</th>
  </tr>
  <tr>
    <td><%= @sector.research %></td>
    <td><%= @sector.restoration %></td>
    <td><%= @sector.geophysics %></td>
    <td><%= @sector.discovery %></td>
  </tr>
  <tr>
    <td></td>
  </tr>

  <tr>
    <th>History of archaeological research</th>
    <th>Heritage Value</th>
    <th>Remarks</th>
  </tr>
  <tr>
    <td><%= @sector.archaeology %></td>
    <td><%= @sector.pat_value %></td>
    <td><%= @sector.remark %></td>
  </tr>
  <tr>
    <td></td>
  </tr>
  <tr>
    <th>Author</th>
    <th>Date</th>
  </tr>
  <tr>
    <td><%= @sector.author %></td>
    <td><%= @sector.created_at.strftime("%d/%m/%Y %H:%M") %></td>
  </tr>
  <tr>
    <th>Bibliography</th>
  </tr>
  <tr>
    <td>
      <% @sector.bibliographies.each do |bibliography| %>
          <ul>
            <li><%= bibliography.abbreviation %>;<%= bibliography.title %></li>
          </ul>
      <% end %>
    </td>
  </tr>
  <tr>
    <td>
      <% @sector.photos.each do |photo| %>
        <ul>
          <li><%=link_to image_tag(photo.image.url(:thumbnail)), photo.image.url(:original), :popup=>['original_image'], :target => '_blank' %></li>
        </ul>
      <% end %>
    </td>
  </tr>
</table>
</div>

<h1>Google Maps</h1>
<div data-no-turbolink>
<div style='width: 800px;' >
  <div id="multi_markers" style='width: 800px; height: 400px;' ></div>
</div>
</div>

<script type="text/javascript">
    var handler = Gmaps.build('Google');
    handler.buildMap({ internal: {id: 'multi_markers'},  provider: {
            zoom:      6,
            mapTypeId: google.maps.MapTypeId.HYBRID
        }},function(){
        markers = handler.addMarkers(<%=raw @hash.to_json %>);


    /*polygons = handler.addPolygons(
        (),
        { strokeColor: '#FF0000', strokeOpacity: 0.8,
            strokeWeight: 2,
            fillColor: "#FFE97F",
            fillOpacity: 0.35}
    );*/

        handler.bounds.extendWith(markers);
       // handler.bounds.extendWith(polygons);
        handler.fitMapToBounds();
        handler.getMap().setZoom(6);

    });
</script>